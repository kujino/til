# 2025/10/15の日報
today: 5 hour, total: 335 hour
## 学習したこと
### ActiveRecordの操作10本ノック
* データベースからActiveRecordのメソッドを使ってデータを取得
* 書いたコード(一部)
```ruby
Category.select("category.category_id, category.name, sum(payment.amount) as revenue")
	.joins(films: { inventories: { rentals: :payments } }) #join文はキーとバリューのハッシュ形式
	.group("category.category_id, category.name")
	.limit(5).order(revenue: :desc)
```

```ruby
Film.select("film.film_id, film.title")
	.joins(:actors) #間に中間テーブルを挟んだテーブルだが、モデルの`through:`表記で取得可能
	.where("actor.first_name = 'JOE'", "actor.last_name = 'SWANK'")
```

```ruby
Film.select("film.film_id, film.title, film.length")
	.joins(:actors)
	.where(actor: { first_name: "JOE", last_name: "SWANK" })
	.where("film.length >= ?", 100)
```

```ruby
Film.joins(:actors, :categories) #関連性のないテーブルのjoin文、なんとなくやったら上手くいった
	.select("film.film_id, film.title")
	.where(category: { name: "Action" })
	.where(actor: { first_name: "JOE", last_name: "SWANK" }) #andを使ってやっていたが上手くいかず、whereを複数回書けばいいだけだった
```

```ruby
Film.joins(:actors, inventories: { rentals: :payments }) #片方はネスト無し、もう片方はネストが必要な場合
	.select("film.film_id, film.title, sum(payment.amount) as revenue")
	.where(actor:{first_name: "JOE", last_name: "SWANK" })
	.group("film.film_id, film.title")
	.order(revenue: :desc)
	.limit(10)
	```

多重JOINや中間テーブルを挟んだ場合のJOIN文記述がはじめよくわからなかったが、一度書き方が分かればSQLの要領でその後の問題もある程度すらすらと解けるようになった。  
Rail応用カリキュラムにて苦手意識があった部分なので少し克服できた気がする。  
というか、rails応用前にやってればrailsの理解をもっと深めれた気がする
